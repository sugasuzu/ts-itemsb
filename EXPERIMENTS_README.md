# 閾値パラメータ実験ガイド

## 概要

3つの閾値パラメータの全組み合わせ（3×3×3 = 27通り）で自動実験を実行するスクリプトです。

**実験パラメータ:**
- `Minsup`: 0.003, 0.004, 0.005
- `MIN_CONCENTRATION`: 0.30, 0.40, 0.50
- `MAX_DEVIATION`: 0.50, 0.75, 1.0

## 使い方

### 1. 実験実行

```bash
./run_experiments.sh
```

**実行時間:** 約30-60分（通貨ペアとデータサイズによる）

**注意:**
- 実行前に `main.c` が自動バックアップされます
- 実験終了後、`main.c` は元の設定に戻ります

### 2. 結果の確認

実験結果は `experiments/YYYYMMDD_HHMMSS/` ディレクトリに保存されます。

**ディレクトリ構造:**
```
experiments/20251114_120000/
├── experiment_summary.csv          # 全実験のサマリー
├── exp01_ms0.003_c0.30_d0.50/     # 実験1の結果
│   ├── parameters.txt              # 実験パラメータ
│   ├── execution.log               # 実行ログ
│   ├── compile.log                 # コンパイルログ
│   └── output/                     # ルール発見結果
│       └── pool/
│           └── zrp01a.txt          # ルールプール
├── exp02_ms0.003_c0.30_d0.75/     # 実験2の結果
│   └── ...
...
└── exp27_ms0.005_c0.50_d1.0/      # 実験27の結果
    └── ...
```

### 3. 結果分析

```bash
python3 analyze_experiments.py experiments/20251114_120000/experiment_summary.csv
```

**出力内容:**
- ルール発見数の基本統計（平均、中央値、標準偏差）
- 各パラメータ別の平均ルール発見数
- Top 5 / Bottom 5 実験
- 全実験の詳細リスト
- 実行時間統計

**出力例:**
```
================================================================================
実験結果分析
================================================================================

入力ファイル: experiments/20251114_120000/experiment_summary.csv
総実験数: 27
成功実験数: 27

================================================================================
ルール発見数の基本統計
================================================================================
平均: 542.3
中央値: 498.0
最小値: 87
最大値: 1245
標準偏差: 234.5

================================================================================
Minsup別の平均ルール発見数
================================================================================
         mean    std  min   max
Minsup
0.003   823.4  145.2  542  1245
0.004   542.1   98.7  312   789
0.005   261.4   67.3   87   456

...
```

## スクリプトのカスタマイズ

### 通貨ペアを変更する

`run_experiments.sh` の12行目を編集:

```bash
PAIR="USDJPY"  # または EURUSD, GBPJPY など
```

### パラメータ範囲を変更する

`run_experiments.sh` の7-9行目を編集:

```bash
MINSUP_VALUES=(0.002 0.004 0.006)      # 任意の値に変更可能
CONC_VALUES=(0.25 0.35 0.45)           # 任意の値に変更可能
DEV_VALUES=(0.40 0.60 0.80)            # 任意の値に変更可能
```

## トラブルシューティング

### コンパイルエラーが発生する

- `main.c` のバックアップファイル（`main.c.backup_YYYYMMDD_HHMMSS`）から手動で復元してください
- `make clean && make` でクリーンビルドを試してください

### 実験が途中で停止する

- `experiments/YYYYMMDD_HHMMSS/expXX_*/execution.log` でエラーログを確認
- ディスク容量を確認（各実験で数MB-数十MBのデータが生成されます）

### main.cが元に戻らない

バックアップから手動で復元:

```bash
cp main.c.backup_YYYYMMDD_HHMMSS main.c
make clean && make
```

## 実験データの管理

### 古い実験結果の削除

```bash
rm -rf experiments/YYYYMMDD_HHMMSS
```

### 全実験結果の一括削除

```bash
rm -rf experiments/
```

## 並列実行（上級者向け）

複数の通貨ペアを同時に実験する場合、スクリプトを複数コピーして別のディレクトリで実行してください。

```bash
# ターミナル1
cd /path/to/project1
./run_experiments.sh  # GBPJPY

# ターミナル2
cd /path/to/project2
./run_experiments.sh  # USDJPY
```

## 関連ファイル

- `run_experiments.sh` - 実験実行スクリプト
- `analyze_experiments.py` - 結果分析スクリプト
- `main.c` - メインプログラム（自動的に書き換えられます）
