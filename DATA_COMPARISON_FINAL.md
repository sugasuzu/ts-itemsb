# データ比較：統計的異常発見のための最適データ選択

## 利用可能データの完全比較

### データセット概要

| データ | レコード数 | 期間 | 頻度 | 銘柄数 | 属性次元 |
|--------|-----------|------|------|--------|---------|
| **仮想通貨** | 17,482 | 2023-11 → 2025-11 | **時間足** | 20 | 60次元 |
| **株式** | ~6,000 | 2000-01 → 2024-11 | 日足 | 220 | 660次元 |
| **為替** | 4,121 | 2010-01 → 2025-10 | 日足 | 20 | 60次元 |

---

## 統計的特性の比較

### 代表銘柄の統計量

| 指標 | BTC (時間足) | 日経225平均 (推定) | USDJPY (日足) |
|------|-------------|------------------|--------------|
| **μ (平均)** | 0.0077% | ~0.02% | 0.0136% |
| **σ (標準偏差)** | **0.5121%** | ~1.5% | 0.5827% |
| **Skewness** | -0.0982 | ~0 | -0.0300 |
| **Kurtosis** | **9.8848** ⭐ | ~3-5 | 3.6983 |
| **Range** | -4.92 ~ +5.08% | -5 ~ +5% | -3.73 ~ +3.82% |

### 重要な発見

#### 1. ボラティリティ（統計的異常の発見しやすさ）

```
時間足換算での比較:
  BTC (時間):     σ = 0.51%/hour
  USDJPY (日):    σ = 0.58%/day  ≈ 0.12%/hour (√24換算)
  株式 (日):      σ ≈ 1.5%/day   ≈ 0.31%/hour (√24換算)

→ BTCの時間足が最も高頻度で変動を観測できる
```

#### 2. ファットテール（極端な異常の頻度）

```
Kurtosis比較（正規分布=3）:
  BTC:      9.88  ← 極端に大きい（ブラックスワン頻出）
  USDJPY:   3.70  ← ほぼ正規分布
  株式:    ~4-5   ← やや大きい

→ BTCは極端な値が出現しやすい（統計的異常発見に最適）
```

#### 3. データ量（統計的検定の信頼性）

```
有効レコード数:
  BTC:      17,482時間  (約2年間)
  USDJPY:    4,121日    (約16年間)
  株式:     ~6,000日    (約24年間)

→ すべて統計的に十分なサンプルサイズ
```

---

## Time-Delay機能の有効性

### 時間遅延の解釈

| データ | 頻度 | t-1の意味 | t-3の意味 | 評価 |
|--------|------|-----------|-----------|------|
| **BTC** | **時間足** | **1時間前** | **3時間前** | ⭐⭐⭐⭐⭐ |
| USDJPY | 日足 | 1日前 | 3日前 | ⭐⭐⭐⭐ |
| 株式 | 日足 | 1日前 | 3日前 | ⭐⭐⭐⭐ |

### Time-Delayの有効性分析

#### BTC（時間足）の場合
```
t-0: 現在の市場状態（MATIC_Stay, ATOM_Up など）
t-1: 1時間前の状態（短期トレンド）
t-2: 2時間前の状態（モメンタム確認）
t-3: 3時間前の状態（初期シグナル）

→ 短期トレンド（3時間以内）のパターン発見に最適
→ 既に検証済み: t-1が53.38%で最も効果的
```

#### USDJPY/株式（日足）の場合
```
t-0: 当日の状態
t-1: 1日前（前日効果）
t-2: 2日前（短期トレンド）
t-3: 3日前（中期トレンド）

→ 日次トレンド（3日間）のパターン発見
→ 株式特有の「曜日効果」「月初効果」の発見可能性
```

---

## 統計的異常の発見可能性

### 基準: Minmean = 0.5% での期待ルール数

| データ | ベースラインσ | 0.5%の意味 | 期待ルール数 | 研究価値 |
|--------|-------------|----------|-------------|---------|
| **BTC** | **0.51%** | **≈1σ** | **50-200個** | **⭐⭐⭐⭐⭐** |
| USDJPY | 0.58% | ≈0.86σ | 30-150個 | ⭐⭐⭐⭐ |
| 株式 | ~1.5% | ≈0.33σ | 100-500個 | ⭐⭐⭐ |

### 解釈

#### BTC: 最適なバランス
```
σ = 0.51%  →  Minmean = 0.5% ≈ 1σ
→ 統計的に有意な閾値
→ 発見されるルールは「明確な異常」
→ 論文化しやすい
```

#### USDJPY: やや厳しめ
```
σ = 0.58%  →  Minmean = 0.5% ≈ 0.86σ
→ 統計的にやや弱い（1σ未満）
→ Minmean = 0.6% に上げる方が良い
```

#### 株式: 緩すぎる
```
σ ≈ 1.5%  →  Minmean = 0.5% ≈ 0.33σ
→ 統計的に弱い（ノイズレベル）
→ Minmean = 1.0-1.5% に上げる必要あり
```

---

## データ固有の特性（発見されるパターンの違い）

### 1. BTC（仮想通貨市場）

**特徴:**
- 24時間365日取引（市場クローズなし）
- 高ボラティリティ
- アルトコイン連動（BTC → ETH → アルトの順）
- ニュース反応が即座に現れる

**発見されるパターン例:**
```
1. モメンタム継続
   IF BTC_Up(t-1) AND ETH_Up(t-1) AND SOL_Up(t-2)
   THEN X(t+1) = +0.8% (市場全体の上昇トレンド)

2. 平均回帰（ファットテール活用）
   IF BTC_Down(t-1) < -2σ AND DOGE_Down(t-0)
   THEN X(t+1) = +1.2% (過度な売りからの反発)

3. 時間帯効果
   - アジア時間（日本9-17時）の薄商い
   - 欧米時間（米国9-17時）の活発な取引
```

### 2. USDJPY（為替市場）

**特徴:**
- 政策金利差の影響大
- キャリートレード
- 長期トレンド（円安/円高）
- インターマーケット連動（株式市場との相関）

**発見されるパターン例:**
```
1. 金利差連動
   IF USDJPY_Up(t-1) AND EURJPY_Up(t-1) AND GBPJPY_Up(t-2)
   THEN X(t+1) = +0.6% (円安トレンド継続)

2. クロス通貨連動
   IF EURUSD_Up(t-2) AND GBPUSD_Up(t-1)
   THEN USDJPY_X(t+1) = -0.5% (ドル安トレンド)

3. 株式連動
   IF 日経225_Up(t-1) AND USDJPY_Up(t-0)
   THEN X(t+1) = +0.5% (リスクオン円安)
```

### 3. 株式（日経225）

**特徴:**
- 長期データ（24年間）
- セクターローテーション
- 曜日効果・月初効果・決算効果
- マクロ経済指標の影響

**発見されるパターン例:**
```
1. 曜日効果
   IF Monday AND Market_Down(t-1)
   THEN X(t+1) = -0.8% (週初下落傾向)

2. セクター連動
   IF トヨタ_Up(t-2) AND ホンダ_Up(t-1) AND 日産_Up(t-0)
   THEN 自動車セクター全体が上昇

3. 月初効果
   IF 月初3営業日 AND Market_Up(t-1)
   THEN X(t+1) = +0.7% (リバランス需要)
```

---

## 推奨データ選択（目的別）

### 🏆 1位: BTC（Bitcoin時間足）

**推奨理由:**
1. ✅ **ファットテール特性** (Kurtosis=9.88) → 極端な異常が頻出
2. ✅ **最適な閾値バランス** (σ=0.51% ≈ Minmean=0.5%)
3. ✅ **時間足データ** → 短期パターンが明確
4. ✅ **既にシステム検証済み** → 動作確認完了
5. ✅ **論文化しやすい** → 代表性、再現性が高い

**使用シナリオ:**
```bash
# Conservative設定（推奨）
./main BTC 10

期待結果:
  - ルール数: 50-200個
  - 平均リターン: ±0.5-1.0%
  - 統計的有意性: 1σ以上
  - 論文価値: 高
```

### 🥈 2位: USDJPY（為替日足）

**推奨理由:**
1. ✅ **長期データ** (16年間) → トレンド検証に有利
2. ✅ **安定したボラティリティ** (σ=0.58%)
3. ✅ **政策との関連** → 解釈しやすい
4. ⚠️ **Minmean調整必要** (0.5% → 0.6%推奨)

**使用シナリオ:**
```bash
# Minmean = 0.6% に設定
./main USDJPY 10

期待結果:
  - ルール数: 30-150個
  - 平均リターン: ±0.6-1.0%
  - 長期トレンドの発見
```

### 🥉 3位: 日経225株式（日足）

**推奨理由:**
1. ✅ **最長データ** (24年間) → 景気サイクル分析可能
2. ✅ **多様なセクター** (220銘柄) → パターン多様性
3. ⚠️ **高ボラティリティ** (σ≈1.5%) → Minmean = 1.0-1.5%必要

**使用シナリオ:**
```bash
# Minmean = 1.0% に設定（株式専用）
./main 7203 10  # トヨタ自動車

期待結果:
  - ルール数: 50-200個
  - 平均リターン: ±1.0-2.0%
  - セクター連動パターン発見
```

---

## 実装フェーズ別推奨

### Phase 1: BTC単独（今週）✅ 最優先

```bash
# 1. Minmean を 0.5% に変更
# 2. BTC 10試行実行
./main BTC 10

目的:
  - Minmean=0.5の効果確認
  - 統計的異常の発見
  - ルール品質の評価
  - 論文化可能性の検証
```

**期待される成果:**
- 現在: 419ルール（Minmean=0.1%）
- 変更後: 50-200ルール（Minmean=0.5%）
- 平均リターン: ±0.5-1.0%（現在の0.13%から大幅改善）
- 統計的有意性: 1σ以上

---

### Phase 2: 為替データ追加（来週）

```bash
# USDJPY でテスト
./main USDJPY 10

目的:
  - 異なる市場での検証
  - BTCとの比較
  - 手法の一般性確認
```

**注意点:**
- Minmean = 0.6% に上げる（σ=0.58%のため）
- 為替特有のパターン（金利差、クロス通貨）に注目

---

### Phase 3: 株式データ追加（再来週）

```bash
# 日経225主要銘柄
./main 7203 10  # トヨタ
./main 9984 10  # ソフトバンク

目的:
  - 長期データでの検証
  - セクター効果の発見
  - 手法の頑健性確認
```

**注意点:**
- Minmean = 1.0-1.5% に上げる（σ≈1.5%のため）
- 曜日効果、月初効果に注目

---

## 最終判定表

### 統計的異常発見に最適なデータは？

| 評価項目 | BTC | USDJPY | 株式 | 勝者 |
|---------|-----|--------|------|------|
| ファットテール | 9.88 ⭐⭐⭐⭐⭐ | 3.70 ⭐⭐ | 4-5 ⭐⭐⭐ | **BTC** |
| ボラティリティ | 0.51%/h ⭐⭐⭐⭐⭐ | 0.12%/h ⭐⭐ | 0.31%/h ⭐⭐⭐ | **BTC** |
| 閾値バランス | 1σ ⭐⭐⭐⭐⭐ | 0.86σ ⭐⭐⭐⭐ | 0.33σ ⭐⭐ | **BTC** |
| データ量 | 17k ⭐⭐⭐⭐ | 4k ⭐⭐⭐ | 6k ⭐⭐⭐⭐ | BTC/株式 |
| Time-Delay効果 | 短期 ⭐⭐⭐⭐⭐ | 中期 ⭐⭐⭐⭐ | 中期 ⭐⭐⭐⭐ | **BTC** |
| 論文化容易性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | **BTC** |

### 総合評価

```
🏆 1位: BTC (Bitcoin) - 5勝
   → 統計的異常発見に最適
   → 今すぐ使うべきデータ

🥈 2位: USDJPY (為替) - 補完的価値
   → 長期トレンド分析に有用
   → BTC検証後に追加推奨

🥉 3位: 日経225 (株式) - 研究拡張用
   → セクター分析に有用
   → 手法の一般性検証に使用
```

---

## 結論

### 🎯 今すぐ使うべきデータ: **BTC (Bitcoin) 時間足**

**最終推奨理由:**

1. **ファットテール特性が最強** (Kurtosis=9.88)
   - 極端な値が頻出 → 統計的異常を発見しやすい
   - ブラックスワンイベントの宝庫

2. **閾値設定が最適** (σ=0.51% ≈ Minmean=0.5%)
   - 1σレベルの閾値 → 統計的に有意
   - ノイズと異常の区別が明確

3. **時間足データが理想的**
   - Time-delay機能が最大限に活用される
   - 短期パターン（1-3時間）が明確に現れる
   - 既に検証済み（t-1が53.38%で最も効果的）

4. **論文化に最適**
   - 市場代表性が高い（時価総額最大）
   - 再現性が高い（流動性十分）
   - 先行研究と比較可能

### 次のアクション

```bash
# Step 1: main.c の閾値変更
#define Minmean 0.5  // 0.1 → 0.5

# Step 2: BTC 10試行実行
./main BTC 10

# Step 3: 結果確認
grep "rules extracted" output/doc/zrd01.txt
```

**期待される論文価値:**
- **統計的異常の発見**: 条件付き分布が無条件分布から1σ以上乖離
- **Time-delay効果の実証**: 過去3時間のパターンが将来を予測
- **ファットテール市場での有効性**: 極端な値が多い市場でこそ威力を発揮

---

## 補足: 為替・株式データの活用

### USDJPYの利点（補完的）

- 長期データ（16年間）→ 経済サイクル分析
- 政策との関連 → 解釈が容易
- Minmean = 0.6% で実行推奨

### 日経225の利点（拡張的）

- 最長データ（24年間）→ 長期検証
- 多様なセクター → パターン多様性
- Minmean = 1.0% で実行推奨

---

**データ選択の最終答え: BTC（Bitcoin）時間足データを使うべき**
