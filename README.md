# GNMiner-TS: 時系列アソシエーションルールマイニングシステム Phase 2

**遺伝的ネットワークプログラミング（GNP）による時系列パターン発見と予測システム**

[![Version](https://img.shields.io/badge/Version-2.0-blue.svg)](https://github.com/gnminer-ts)
[![Language](https://img.shields.io/badge/Language-C-green.svg)](https://github.com/gnminer-ts)
[![License](https://img.shields.io/badge/License-Research-orange.svg)](LICENSE)

---

## 🎯 Phase 2 主要アップデート

### 新機能

- **📅 時間変数T完全統合**: タイムスタンプから年月日、曜日、四半期を自動解析
- **📊 時間パターン分析**: 月別・四半期別・曜日別の統計的パターン検出
- **📈 可視化データ生成**: 発見ルールの時系列推移をCSV出力
- **🔍 支配的パターン特定**: 最も影響力のある時間パターンを自動認識

---

## 📋 目次

1. [システム概要](#システム概要)
2. [Phase 2で可能になった分析](#phase-2で可能になった分析)
3. [クイックスタート](#クイックスタート)
4. [システムアーキテクチャ](#システムアーキテクチャ)
5. [発見されるルール形式](#発見されるルール形式)
6. [ビルドと実行](#ビルドと実行)
7. [出力ファイル詳細](#出力ファイル詳細)
8. [パラメータ設定](#パラメータ設定)
9. [応用例](#応用例)
10. [トラブルシューティング](#トラブルシューティング)

## システム概要

GNMiner-TSは、進化計算手法の一つである**遺伝的ネットワークプログラミング（GNP）**を用いて、時系列データから有用なアソシエーションルールを自動的に発見するC言語実装のデータマイニングシステムです。

### 核心技術

- **時間遅延の自動最適化**: どのくらい過去のデータ(t-d)が未来(t+1)に影響するか
- **適応的遅延学習**: 有望な遅延パターンを学習し進化を最適化
- **時間パターン分析**: カレンダー効果や季節性の自動検出（Phase 2新機能）

---

## Phase 2で可能になった分析

### 📊 統計学的観点

#### 1. 季節性分析

- **月次パターン**: 「月末効果」の定量化
- **四半期パターン**: 決算期特有の変動検出
- **曜日効果**: 週内アノマリーの発見

#### 2. 時系列分解

- トレンド成分、季節成分、不規則成分への自動分解
- 構造変化点の検出
- 長期記憶性の評価

#### 3. 統計的有意性

- 時間パターンのカイ二乗検定
- 分散の時間的安定性評価
- 予測精度のクロスバリデーション

### 🔬 研究者観点

#### 1. 因果関係の時間構造

**発見例**: 「イベントA(t-3) → 効果B(t+1)」
3日の遅延で因果関係が存在

#### 2. 複合的時間パターン

「月曜日 ∧ 月初 ∧ 前週高ボラティリティ → 特定の市場行動」

### 💹 金融市場分析観点

#### 1. 市場アノマリー検出
- **月曜効果**: 週初の特異な値動き
- **月末効果**: ウィンドウドレッシング
- **四半期効果**: 決算期の特殊な動き

#### 2. 実践的なトレーディングルール

**例**:
```
15_Up(t-2) ∧ 3_Signal(t-0) ∧ Friday(t-0) ∧ Q3(t-0) → Price_Rise(t+1): 信頼度85%
```

**解釈**: 指標15が2日前上昇、シグナル3が本日発生、金曜日かつ第3四半期の場合、翌日価格上昇の確率が高い

---

## クイックスタート

### 前提条件

- GCC 4.8以降
- Linux/Unix環境（Windows WSL対応）
- 512MB以上のメモリ

### インストールと実行

```bash
# 1. リポジトリのクローン
git clone https://github.com/your-repo/gnminer-ts.git
cd gnminer-ts

# 2. Phase 2バージョンのコンパイル
gcc -o gnminer_phase2 gnminer_phase2.c -lm -O2

# 3. 実行
./gnminer_phase2

# 4. 進捗確認（別ターミナル）
tail -f output/doc/zrd01.txt
```

---

## システムアーキテクチャ

### データフロー図

```
入力データ (CSV)
    ↓
[CSVヘッダー解析]
    ↓
[時間情報抽出] ← Phase 2新機能
    ├── 年月日解析
    ├── 曜日計算
    └── 四半期判定
    ↓
[GNP進化エンジン]
    ├── 時系列評価
    ├── ルール抽出
    └── 適応的学習
    ↓
[時間パターン分析] ← Phase 2新機能
    ├── 月別統計
    ├── 四半期別統計
    └── 曜日別統計
    ↓
出力ファイル群
    ├── ルールプール (pool/)
    ├── 可視化データ (vis/) ← Phase 2新機能
    └── 分析レポート (doc/)
```

---

## 発見されるルール形式

### Phase 2拡張ルール形式

```
IF   A1(t-d1) = 1 ∧ A2(t-d2) = 1 ∧ ... ∧ An(t-dn) = 1
     ∧ [時間条件: 月=M, 四半期=Q, 曜日=W]
THEN X(t+1) ∈ [μx ± σx]
```

### 時間パターン統計

- **月別分布**: M1(15%), M2(8%), ..., M12(12%)
- **四半期別**: Q1(22%), Q2(28%), Q3(25%), Q4(25%)
- **曜日別**: Mon(18%), Tue(15%), ..., Sun(10%)

---

## ビルドと実行

### コンパイルオプション

```bash
# 標準ビルド
gcc -o gnminer_phase2 gnminer_phase2.c -lm -O2

# デバッグビルド（詳細ログ出力）
gcc -o gnminer_phase2 gnminer_phase2.c -lm -O2 -DDEBUG

# 最適化ビルド（実行速度優先）
gcc -o gnminer_phase2 gnminer_phase2.c -lm -O3 -march=native
```

### 実行時間の目安

| 設定 | 時間 |
|------|------|
| 1試行（201世代） | 30秒〜1分 |
| 100試行（標準） | 50分〜100分 |
| データ1000件 | 約2倍 |

## 出力ファイル詳細

### ディレクトリ構造

```
output/
├── IL/        # 個別試行のルールリスト
├── IA/        # 進捗レポート
├── IB/        # バックアップファイル
├── pool/      # グローバルルールプール
│   ├── zrp01a.txt  # 属性名表記（Phase 2: 時間情報追加）
│   └── zrp01b.txt  # 要約統計
├── doc/       # ドキュメンテーション
│   └── zrd01.txt   # 実行統計
└── vis/       # 可視化データ（Phase 2新規）
    └── rule_XXXX_YYYY.csv  # ルール別時系列データ
```

### Phase 2新出力: pool/zrp01a.txt

```
# ヘッダー（Phase 2拡張版）
Attr1   Attr2   ...   X_mean  X_sigma Support HighSup LowVar  Month Quarter Day StartDate EndDate

# サンプル行
15(t-2) 3(t-0) 0 0 0 0 0 0  12.34  0.45  25  156  1  1  3  1  2  2024-03-01  2024-03-31
```

### Phase 2新出力: vis/rule_XXXX_YYYY.csv

```csv
Timestamp,X,X_mean,X_sigma,Matched,Month,Quarter,DayOfWeek
2024-01-01,10.5,12.34,0.45,0,1,1,1
2024-01-02,11.2,12.34,0.45,1,1,1,2
...
```

## パラメータ設定

### Phase 2追加パラメータ

| パラメータ | デフォルト | 説明 | 推奨範囲 |
|-----------|----------|------|---------|
| DAYS_IN_WEEK | 7 | 曜日数 | 固定 |
| MONTHS_IN_YEAR | 12 | 月数 | 固定 |
| QUARTERS_IN_YEAR | 4 | 四半期数 | 固定 |
| MAX_LAG | 10 | 自己相関の最大ラグ | 5-20 |

### 既存パラメータ（調整済み）

| パラメータ | Phase 1 | Phase 2 | 変更理由 |
|-----------|---------|---------|---------|
| MAX_TIME_DELAY | 3 | 3 | 維持 |
| Nmx | 7 | 7 | 維持 |
| OUTPUT_DIR_VIS | - | 追加 | 可視化用 |

## 応用例

### 1. 株価予測（Phase 2拡張）

**発見ルール例**:
```
「出来高増加(t-2) ∧ RSI<30(t-1) ∧ 月曜日 ∧ 月初」→ 価格上昇確率: 78%
```

**活用方法**:
- 曜日効果を考慮したエントリータイミング
- 月初効果を利用したポジション調整

### 2. 製造業の品質管理

**発見ルール例**:
```
「温度上昇(t-3) ∧ 湿度高(t-1) ∧ 金曜日」→ 不良品率上昇リスク: 85%
```

**対策**:
- 金曜日の品質チェック強化
- 週末前の環境管理徹底

### 3. 小売業の需要予測

**発見ルール例**:
```
「広告実施(t-7) ∧ 週末 ∧ 月末」→ 売上増加: 平均+35%
```

**戦略**:
- 月末週末に向けた在庫調整
- プロモーション最適化

## トラブルシューティング

### Phase 2特有の問題

| 問題 | 原因 | 対処法 |
|------|------|--------|
| 時間解析エラー | 日付形式不正 | YYYY-MM-DD形式を確認 |
| メモリ不足（Phase 2） | 時間統計配列が大きい | MAX_LAGを削減 |
| 可視化ファイル未生成 | ディレクトリ権限 | `mkdir -p output/vis`実行 |

### デバッグ手順

```bash
# 1. 時間解析の確認
./gnminer_phase2 | grep "Time range"

# 2. メモリ使用量監視
valgrind --leak-check=full ./gnminer_phase2

# 3. 可視化データ確認
head -n 10 output/vis/rule_1000_0001.csv
```

---

## 今後の開発予定

### Phase 3（計画中）

- 🔄 リアルタイム学習機能
- 📊 3次元以上の多変量対応
- 🚀 GPU並列化による高速化

### Phase 4（構想段階）

- 🌐 Webベースの可視化UI
- 🤖 AutoML統合
- ☁️ クラウド分散処理

---

## 貢献方法

1. このリポジトリをフォーク
2. 機能ブランチを作成 (`git checkout -b feature/AmazingFeature`)
3. 変更をコミット (`git commit -m 'Add some AmazingFeature'`)
4. ブランチにプッシュ (`git push origin feature/AmazingFeature`)
5. プルリクエストを作成

---

## ライセンス

研究目的での使用は自由です。商用利用についてはお問い合わせください。

---

## 謝辞

- 遺伝的ネットワークプログラミングの開発者
- 時系列分析手法の研究者コミュニティ
- オープンソースコントリビューター

---

## 参考文献

1. K. Hirasawa et al., "Association Rule Mining with GNP," IEEE Trans. SMC, 2006
2. K. Shimada et al., "Time-Related Association Rules," SICE Journal, 2010
3. Phase 2実装論文（投稿準備中）

---

**Document Version**: 2.0.0
**Last Updated**: 2024
**Phase**: 2 (Temporal Pattern Analysis)
**Status**: Production Ready